<!DOCTYPE html>
<html>
<head>
	<meta charset="utf-8">
	<meta name="viewport" content="width=device-width, initial-scale=1">
	<title>Encounter Generator</title>
	<style>
		body {text-align: center;}
	</style>
	<link href="https://cdn.jsdelivr.net/npm/bootstrap@5.3.0/dist/css/bootstrap.min.css" rel="stylesheet" integrity="sha384-9ndCyUaIbzAi2FUVXJi0CjmCapSmO7SnpJef0486qhLnuZ2cdeRhO02iuK6FUUVM" crossorigin="anonymous">
	<script src="https://cdn.jsdelivr.net/npm/bootstrap@5.3.0/dist/js/bootstrap.bundle.min.js" integrity="sha384-geWF76RCwLtnZ8qwWowPQNguL3RmwHVBC9FhGdlKrxdiJJigb/j/68SIy3Te4Bkz" crossorigin="anonymous"></script>
</head>
<body class="text-center">
	<script>
		let round = 1
		let deck = [{"attack": [3, 4, 5, 5], "defense": ["Barrel Roll - Avoid 2 hits", "Wingman - busy, no help"], "defensive fire": "0 hits"}, {"attack": [3, 3, 4, 5], "defense": ["Evasives - Avoid all damage", "Wingman attacks with 5FP"], "defensive fire": "2 hits"}, {"attack": [4, 4, 5, 6], "defense": ["Tight Turn - Improve x1 x2 if rotary engine", "Wingman busy, no help"], "defensive fire": "0 hits"}]
		shuffle(deck)
		const experienceLevelEarly = ["Green", "Trained", "Trained", "Trained", "Veteran", "Ace"]
		const experienceLevelLate = ["Trained", "Trained", "Trained", "Veteran", "Veteran", "Ace"]
		let enemyExperience
		function generateExperience(experienceArray) {
			enemyExperience = experienceArray[Math.floor(Math.random() * experienceArray.length)]
			return "Experience generated";
		}
		function generateResult() {
			let enemy = document.getElementById("enemy-firepower");
			let player = document.getElementById("player-firepower");
			let enemyFirepower = enemy.options[enemy.selectedIndex].value;
			let playerFirepower = player.options[player.selectedIndex].value;
			let positionValue = document.getElementById("player-position");
			let position = positionValue.options[player.selectedIndex].value;
			let playerCard = deck[0]
			let enemyCard = deck[1]
			let enemyBonus = 0
			let playerBonus = 0
			if (position === "Tailed") {
				enemyBonus += 1
			}
			else if (position === "Tailing") {
				playerBonus += 1
			}
			shuffle(deck)
			return `Enemy hits: ${enemyCard["attack"][parseInt(enemyFirepower)] + enemyBonus}, player hits ${playerCard["attack"][parseInt(playerFirepower)] + playerBonus}`
		}
		function shuffle(array) {
		  let currentIndex = array.length,  randomIndex;

		  // While there remain elements to shuffle.
		  while (currentIndex !== 0) {

			// Pick a remaining element.
			randomIndex = Math.floor(Math.random() * currentIndex);
			currentIndex--;

			// And swap it with the current element.
			[array[currentIndex], array[randomIndex]] = [
			  array[randomIndex], array[currentIndex]];
		  }

		  return array;
		}
		function generateHits() {
			let numberOfHits = document.getElementById("number-of-hits");
			let numberOfHitsValue = numberOfHits.options[numberOfHits.selectedIndex].value;
			let possibleResults = ["<span class='my-1 px-2 py-1' style='border-radius:5px;color:whitesmoke; background-color:darkred'>Crew Injury</span>",
				"<span class='my-1 px-2 py-1' style='border-radius:5px;color:darkslategray; background-color:palegoldenrod'>Port Strut</span>",
				"<span class='my-1 px-2 py-1' style='border-radius:5px;color:darkslategray; background-color:darkkhaki'>Stbd. Strut</span>",
				"<span class='my-1 px-2 py-1' style='border-radius:5px;color:darkslategray; background-color:burlywood'>Canvas</span>",
				"<span class='my-1 px-2 py-1' style='border-radius:5px;color:lightgray; background-color:darkgreen'>Lndg. Gear</span>",
				"<span class='my-1 px-2 py-1' style='border-radius:5px;color:midnightblue; background-color:steelblue'>Fuel Tank</span>",
				"<span class='my-1 px-2 py-1' style='border-radius:5px;color:lightgray; background-color:darkgreen'>Lndg. Gear</span>",
				"<span class='my-1 px-2 py-1' style='border-radius:5px;color:darkslategray; background-color:burlywood'>Canvas</span>",
				"<span class='my-1 px-2 py-1' style='border-radius:5px;color:lightsalmon; background-color:firebrick'>Engine</span>",
				"<span class='my-1 px-2 py-1' style='border-radius:5px;color:darkslategray; background-color:palegoldenrod'>Port Strut</span>",
				"<span class='my-1 px-2 py-1' style='border-radius:5px;color:lightsalmon; background-color:firebrick'>Engine</span>",
				"<span class='my-1 px-2 py-1' style='border-radius:5px;color:darkslategray; background-color:burlywood'>Canvas</span>",
				"<span class='my-1 px-2 py-1' style='border-radius:5px;color:black; background-color:lightsteelblue'>Tail</span>",
				"<span class='my-1 px-2 py-1' style='border-radius:5px;color:darkslategray; background-color:burlywood'>Canvas</span>",
				"<span class='my-1 px-2 py-1' style='border-radius:5px;color:darkslategray; background-color:palegoldenrod'>Port Strut</span>",
				"<span class='my-1 px-2 py-1' style='border-radius:5px;color:darkslategray; background-color:burlywood'>Canvas</span>",
				"<span class='my-1 px-2 py-1' style='border-radius:5px;color:darkslategray; background-color:palegoldenrod'>Port Strut</span>",
				"<span class='my-1 px-2 py-1' style='border-radius:5px;color:white; background-color:lightpink'>Controls</span>",
				"<span class='my-1 px-2 py-1' style='border-radius:5px;color:darkslategray; background-color:burlywood'>Canvas</span>",
				"<span class='my-1 px-2 py-1' style='border-radius:5px;color:darkslategray; background-color:palegoldenrod'>Port Strut</span>",
				"<span class='my-1 px-2 py-1' style='border-radius:5px;color:lightgray; background-color:black'>Rear Guns</span>",
				"<span class='my-1 px-2 py-1' style='border-radius:5px;color:darkslategray; background-color:burlywood'>Canvas</span>",
				"<span class='my-1 px-2 py-1' style='border-radius:5px;color:darkslategray; background-color:darkkhaki'>Stbd. Strut</span>",
				"<span class='my-1 px-2 py-1' style='border-radius:5px;color:white; background-color:darkslategrey'>Fwd. Wpns.</span>",
				"<span class='my-1 px-2 py-1' style='border-radius:5px;color:darkslategray; background-color:darkkhaki'>Stbd. Strut</span>",
				"<span class='my-1 px-2 py-1' style='border-radius:5px;color:darkslategray; background-color:burlywood'>Canvas</span>",
				"<span class='my-1 px-2 py-1' style='border-radius:5px;color:darkslategray; background-color:darkkhaki'>Stbd. Strut</span>",
				"<span class='my-1 px-2 py-1' style='border-radius:5px;color:lightgray; background-color:darkgreen'>Lndg. Gear</span>",
				"<span class='my-1 px-2 py-1' style='border-radius:5px;color:darkslategray; background-color:burlywood'>Canvas</span>",
				"<span class='my-1 px-2 py-1' style='border-radius:5px;color:lightgray; background-color:black'>Rear Guns</span>",
				"<span class='my-1 px-2 py-1' style='border-radius:5px;color:black; background-color:lightsteelblue'>Tail</span>",
				"<span class='my-1 px-2 py-1' style='border-radius:5px;color:darkslategray; background-color:darkkhaki'>Stbd. Strut</span>",
				"<span class='my-1 px-2 py-1' style='border-radius:5px;color:darkslategray; background-color:burlywood'>Canvas</span>",
				"<span class='my-1 px-2 py-1' style='border-radius:5px;color:white; background-color:darkslategrey'>Fwd. Wpns.</span>",
				"<span class='my-1 px-2 py-1' style='border-radius:5px;color:darkslategray; background-color:burlywood'>Canvas</span>",
				"<span class='my-1 px-2 py-1' style='border-radius:5px;color:midnightblue; background-color:steelblue'>Fuel Tank</span>"]
			let sentence = ""
			console.log(parseInt(numberOfHitsValue))
			for (i=0; i < parseInt(numberOfHitsValue); i++) {
				shuffle(possibleResults)
				if (sentence.length === 0) {
					sentence += possibleResults[0]
				}
				else {
					sentence += `, ${possibleResults[0]}`
				}
			}
			return `Hits: ${sentence}.`
		}
	</script>
	<h1>Encounter Generator</h1>
	<button  class="btn btn-primary mt-2" type="button"
	onclick="document.getElementById('demo').innerHTML = generateExperience(experienceLevelEarly)">
	Enemy experience Sep 1916 - Dec 1917</button>
	<button  class="btn btn-primary mt-2" type="button"
	onclick="document.getElementById('demo').innerHTML = generateExperience(experienceLevelLate)">
	Enemy experience Jan 1918 - Oct 1918</button>
	<div class="dropdown mt-2">
		<label for="enemy-firepower">Enemy firepower </label>
		<select id="enemy-firepower">
		  <option value="0" selected="selected">2</option>
		  <option value="1">3</option>
		  <option value="2">4</option>
			<option value="3">5</option>
		</select>
		<label for="player-firepower">Player firepower </label>
		<select id="player-firepower">
		  <option value="0" selected="selected">2</option>
		  <option value="1">3</option>
		  <option value="2">4</option>
			<option value="3">5</option>
		</select>
		<label for="player-position">Player Position </label>
		<select id="player-position">
		  <option value="Tailing">Tailing</option>
		  <option value="Advantaged">Advantaged</option>
		  <option value="Head-On" selected="selected">Head-On</option>
			<option value="Disadvantaged">Disadvantaged</option>
			<option value="Being Tailed">Being Tailed</option>
		</select>
	</div>
	<div class="dropdown mt-2">
		<label for="number-of-hits">Number of hits</label>
		<select id="number-of-hits">
		  <option value="1">1</option>
		  <option value="2">2</option>
		  <option value="3" selected="selected">3</option>
			<option value="4">4</option>
			<option value="5">5</option>
			<option value="6">6</option>
			<option value="7">7</option>
			<option value="8">8</option>
			<option value="9">9</option>
		</select>
	</div>

	<button type="button" id="generate-result" class="btn btn-danger mt-2" onclick="document.getElementById('demo').innerHTML = generateResult(); round++; document.getElementById('generate-result').innerHTML = `Round ${round} generate result`">Round 1 generate result</button>
	<button type="button" id="generate-hits" class="btn btn-danger mt-2" onclick="document.getElementById('demo3').innerHTML = generateHits()">Generate hits</button>
	<p id="demo"></p>
	<p id="demo2"></p>
	<p id="demo3"></p>
</body>
</html>